<div class="container">

<table style="width: 100%;"><tr>
<td>filter_nfi</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Filter National Forest Inventory Data</h2>

<h3>Description</h3>

<p>The <code>filter_nfi()</code> function provides hierarchical and non-hierarchical filtering approaches for the complex structure of National Forest Inventory data based on user-provided condition expressions (<code>expr_texts</code>).
This function enables effective filtering while maintaining the relationship between plot data (parent data) and other data (child data).
</p>


<h3>Usage</h3>

<pre><code class="language-R">filter_nfi(data, expr_texts, hier = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>: A <code>list</code> generated by <code>read_nfi</code>. Each dataframe should have a 'SUB_PLOT' column.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>expr_texts</code></td>
<td>
<p>: @param expr_texts : A character vector; expressions specifying filtering conditions. Each expression should combine the dataframe name, dollar sign, and condition, with separate expressions for each data frame. (e.g., c("plot$OWN_CD == '5'", "tree$FAMILY == 'Pinaceae'"). Conditions must be valid R expressions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hier</code></td>
<td>
<p>: A logical flag (default TRUE); indicates whether to apply hierarchical filtering (<code>TRUE</code>) or non-hierarchical filtering (<code>FALSE</code>). Hierarchical filtering ensures that connected dataframes are filtered based on the results of filters applied to the parent frame.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function parses expressions targeting specific columns in the dataframes within the provided list.
</p>
<p>Expression requirements:
</p>

<ul>
<li>
<p> Each expression in <code>expr_texts</code> must start with a valid dataframe name in the list (e.g., "plot", "tree", "cwd") and combine the dataframe name, dollar sign, and condition (e.g. c("plot$OWN_CD == '5'").
</p>
</li>
<li>
<p> Separate expressions must be provided for each dataframe being filtered (e.g. c("plot$OWN_CD == '5'", "tree$FAMILY == 'Pinaceae' | tree$WDY_PLNTS_TYP_CD == '1'").
</p>
</li>
</ul>
<p>Hierarchical filtering (<code>hier = TRUE</code>):
</p>

<ul>
<li>
<p> Filters applied to plot table affect all connected child data (tree, CWD, stump, etc.).
</p>
</li>
<li>
<p> Filters applied to child data only operate within that dataframe and do not affect other dataframes.
</p>
</li>
<li>
<p> Example: If only coniferous forest subplots are selected in the plot table, the child data will retain only the tree, CWD, stump, etc., associated with those subplots.
</p>
</li>
</ul>
<p>Non-hierarchical filtering (<code>hier = FALSE</code>):
</p>

<ul>
<li>
<p> Filters applied to the parent dataframe (plot table) do not affect the child data.
</p>
</li>
<li>
<p> Filtering results from child data affect all other parent and child data.
</p>
</li>
<li>
<p> Example: If only certain species are selected in the tree table, the plot table, CWD table, stump table, etc., will be filtered based on the remaining subplots from this selection.
</p>
</li>
</ul>
<h3>Value</h3>

<p>A <code>list</code> of dataframes.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data("nfi_donghae")

# Applying hierarchical filtering to select only privately owned forest subplots.
# Ensures all child tables' subplots match the filtered plot table's subplots.
# Expected results after filtering:
# all(nfi_donghae$tree$SUB_PLOT %in% nfi_donghae$plot$SUB_PLOT)  result: TRUE
nfi_donghae &lt;- filter_nfi(nfi_donghae, c("plot$OWN_CD == '5'"), hier = TRUE)

 
# Non-hierarchical filtering to select only privately owned forest subplots.
# Child tables remain unfiltered and may not correspond to the plot table subplots.
# Expected results after filtering:
# all(nfi_donghae$tree$SUB_PLOT %in% nfi_donghae$plot$SUB_PLOT)  result: FALSE
nfi_donghae &lt;- filter_nfi(nfi_donghae, c("plot$OWN_CD == '5'"), hier = FALSE)

# Non-Hierarchical Filtering with only woody plants.
# Other tables remain filtered and correspond to the tree table.
# Expected results after filtering:
# all(nfi_donghae$plot$SUB_PLOT %in% nfi_donghae$tree$SUB_PLOT)  result: TRUE
nfi_donghae &lt;- filter_nfi(nfi_donghae, c("tree$WDY_PLNTS_TYP_CD == '1'"), hier = FALSE)

# Combining multiple filters across different dataframes
nfi_donghae &lt;- filter_nfi(nfi_donghae, 
                    c("plot$OWN_CD == '5'", 
                    "tree$FAMILY == 'Pinaceae' | tree$WDY_PLNTS_TYP_CD == '1'"))


</code></pre>


</div>