<div class="container">

<table style="width: 100%;"><tr>
<td>kobo_xls_dl</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Downloads data (xls type) from Kobotoolbox</h2>

<h3>Description</h3>

<p>'kobo_xls_dl' is a wrapper for kobotoolbox API that attemps to download data in excel compatible formal.
</p>


<h3>Usage</h3>

<pre><code class="language-R">kobo_xls_dl(
  url = "eu.kobotoolbox.org",
  uname = "",
  pwd = "",
  assetid = "",
  all = "false",
  lang = "_default",
  hierarchy = "false",
  include_grp = "true",
  grp_sep = "/",
  multi_sel = "both",
  media_url = "true",
  fields = NULL,
  sub_ids = NULL,
  sleep = 2
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>url</code></td>
<td>
<p>The '[url]' of kobotoolbox Default is "eu.kobotoolbox.org".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>uname</code></td>
<td>
<p>is username of your kobotoolbox account</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pwd</code></td>
<td>
<p>is the password of the account</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>assetid</code></td>
<td>
<p>is the id of the asset for which the export is to be created</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>all</code></td>
<td>
<p>takes logical value in string format. Used to specify whether fields from all form versions will be included in the export.Acceptable values are "true" or "false". Default value is "false".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lang</code></td>
<td>
<p>takes the language. For e.g. "English (en)". For "XML Values as headers", use '_xml'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hierarchy</code></td>
<td>
<p>takes logical value in string format. Used to specify whether the group hierarchy will be displayed in labels. Acceptable values are "true" or "false". Default value is "false".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>include_grp</code></td>
<td>
<p>defines whether or not to include groups. Default value is "true".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grp_sep</code></td>
<td>
<p>is the group separator. Default value is "/".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>multi_sel</code></td>
<td>
<p>is used to specify the display of multiple_select-type responses. Valid inputs include "both", "summary" or "details". Default is "both".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>media_url</code></td>
<td>
<p>This will include an additional column for media-type questions ("question_name_URL") with the URL link to the hosted file. Valid inputs are "true" or "false". Default value is true.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fields</code></td>
<td>
<p>is an array of column names to be included in the export (including their group hierarchy). Valid inputs include:
An array containing any string value that matches the XML column name,
An empty array which will result in all columns being included,
If "fields" is not included in the "export_settings", all columns will be included in the export</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sub_ids</code></td>
<td>
<p>is an array of submission ids that will filter exported submissions to only the specified array of ids. Valid inputs include an array containing integer values or an empty array.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sleep</code></td>
<td>
<p>is the sleep time between API actions. For example, it takes time to download an export. But R does not wait for the download to finish before going to next step. Hence the need to provide a break between consecutive API actions. Default value is 2 (seconds).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function creates an export of survey data in 'xls'. If successful, it attempts to download the data and and return a data frame (reading using 'readxl::read_excel').
</p>


<h3>Value</h3>

<p>The function returns a data frame of data downloaded from 'Kobotoolbox'.
</p>


</div>