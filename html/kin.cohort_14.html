<div class="container">

<table style="width: 100%;"><tr>
<td>simulations</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> simulation of kin cohort studies </h2>

<h3>Description</h3>

<p>Functions to simulate data for kin-cohort analysis
</p>


<h3>Usage</h3>

<pre><code class="language-R">
kc.simul(nfam, f, hr, rand = 0, mean.sibs = 2, mean.desc = 1.5, 
         a.age = 8, b.age = 80, a.cancer = 3, b.cancer = 180 )

sample.caco(object, p.cases = 1, caco.ratio = 1, verbose = TRUE)

## S3 method for class 'kin.cohort.sample'
summary(object,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>nfam</code></td>
<td>
<p>number of families to be generated </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p>allele frequency</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hr</code></td>
<td>
<p>hazard ratio for disease carriers relative noncarriers</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rand</code></td>
<td>
<p>variance of random effect for cancer incidence (ratio of hr)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean.sibs</code></td>
<td>
<p> mean number of sibllings and descendants (~Poisson)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean.desc</code></td>
<td>
<p> mean number of sibllings and descendants (~Poisson)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a.age</code></td>
<td>
<p>shape parameter for age (~Weibull)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b.age</code></td>
<td>
<p>scale parameter for age (~Weibull)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a.cancer</code></td>
<td>
<p>shape parameter for cancer incidence (~Weibull)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b.cancer</code></td>
<td>
<p>scale parameter for cancer incidence (~Weibull)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>object of class <code>kin.cohort.sample</code> and <code>data.frame</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.cases</code></td>
<td>
<p>proportion of cases (affected) to include in sample. if more than 1, the exact number is assumed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>caco.ratio</code></td>
<td>
<p> ratio of controls per case to include in sample </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>show the number of cases and controls sampled</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>kc.simul</code> will generate a cohort of probands of size <code>nfam</code>. Default parameters simulate a typical cancer study. Each of them will be assigned: a <code>carrier</code> status with probability <code class="reqn">f^2+2f(1-f)</code>; a current <code>age</code> 
drawn from a Weibull distribution with parameters <code>a.age</code> and <code>b.age</code>; an age at diagnosis (<code>agecancer</code>) drawn from 
a Weibull distribution with parameters <code>a.cancer</code> and <code>b.cancer</code>, if noncarrier. For carries, the scale (<code>b.cancer</code>) is 
shifted to get the desired hazard ratio (<code>hr</code>). If <code>rand</code>&gt;0, then a family specific random effect is also added, drawn from a normal distribution with mean 0 and sd <code>rand</code>.
If <code>agecancer</code>&lt; <code>age</code> then the disease status (<code>cancer</code>) will be 1, 0 otherwise. 
</p>
<p>First degree relatives are generated for each proband: two parents, a random number of sibblings (drawn from a Poisson withe mean <code>mean.sibs</code>), and 
a random number of descendants (drawn from a Poisson with mean <code>mean.desc</code>). Each of them is assiggned a <code>carrier</code> status with probability according 
to mendelian transmission conditional of the proband carrier status. 
Current <code>age</code> for relatives are generated conditional on the proband's age, with random draws from normal distribution. Age at diagnosis (<code>agecancer</code>) is assumed independent, except for the optional family random effect.
Gender is assigned at random with probability 0.5 for all individuals.
</p>
<p>Note that the simulation of residual familial correlation with a random effect (<code>rand$&gt;0</code>) does not mantain the desired hazard ratio (<code>hr</code>).
</p>
<p>The generic function <code>summary</code> will show the number and proportion of carriers and affected subjects in the sample.
</p>
<p><code>sample.caco</code> will sample (from a simulation generated by <code>kc.simul</code>) a subset of cases (afected probands) and controls (unaffected probands) and their relatives. Currently only random sampling of controls is implemented (no matching). Sampling fraction is controled by <code>caco.ratio</code>.
</p>
<p>Currently, only one gene and one disease are simulated.
</p>


<h3>Value</h3>

<p>object of class <code>kin.cohort.sample</code> and <code>data.frame</code> with fields
</p>
<table>
<tr style="vertical-align: top;">
<td><code>famid </code></td>
<td>
<p>family id</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rel</code></td>
<td>
<p> relative type (0=proband, 1=parents, 2=sibblings, 3=descendants)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>age</code></td>
<td>
<p> current age of each subject</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gender</code></td>
<td>
<p>gender (0=male, 1=female)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>carrier</code></td>
<td>
<p>carrier status of proband (0=noncarrier, 1=carrier), common for all family members </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cancer</code></td>
<td>
<p>affected (0=no, 1=yes) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>agecancer</code></td>
<td>
<p> age at diagnosis or current age if not affected</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>real.carrier</code></td>
<td>
<p> carrier status or relatives (0=noncarrier, 1=carrier ) </p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
set.seed(7)
## cohort 
s&lt;-kc.simul(4000, f=0.03, hr=5)
summary(s)

## exclude probands
m.coh&lt;- kc.marginal(s$agecancer, s$cancer, factor(s$carrier), s$rel,
                    knots=c(30,40,50,60,70,80,90), f=0.03)
m.coh

## relatives only
r.coh&lt;- coxph(Surv(agecancer,cancer)~real.carrier, data=s)
print(exp(coef(r.coh)))

## probands only
p.coh&lt;- coxph(Surv(agecancer,cancer)~carrier, data=s)
print(exp(coef(p.coh)))

## case-control
s.cc&lt;- sample.caco(s)
summary(s.cc)

## exclude probands
m.caco&lt;- kc.marginal(s.cc$agecancer, s.cc$cancer, factor(s.cc$carrier), 
                     s.cc$rel, knots=c(30,40,50,60,70,80,90), f=0.03)
m.caco

## relatives only
r.caco&lt;- glm(cancer~real.carrier, family=binomial, data=s.cc, subset=(s.cc$rel!=0))
print(exp(coef(r.caco)[2]))

## probands only
p.caco&lt;- glm(cancer~carrier, family=binomial, data=s.cc, subset=(s.cc$rel==0))
print(exp(coef(p.caco)[2]))

## End(Not run)
</code></pre>


</div>