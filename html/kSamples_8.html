<div class="container">

<table style="width: 100%;"><tr>
<td>JT.dist</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Null Distribution of the 
Jonckheere-Terpstra k-Sample Test Statistic
</h2>

<h3>Description</h3>

<p>The
Jonckheere-Terpstra k-sample test statistic JT is defined
as <code class="reqn">JT = \sum_{i&lt;j} W_{ij}</code> where
<code class="reqn">W_{ij}</code> is the Mann-Whitney statistic comparing 
samples <code class="reqn">i</code> and <code class="reqn">j</code>, indexed in the order 
of the stipulated increasing alternative. 
It is assumed that there are no ties
in the pooled samples.
</p>
<p>This function uses Harding's algorithm as far as computations
are possible without becoming unstable.
</p>


<h3>Usage</h3>

<pre><code class="language-R">djt(x, nn)

pjt(x, nn)

qjt(p, nn)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a numeric vector, typically integers</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nn</code></td>
<td>
<p>a vector of integers, representing the sample sizes
in the order stipulated by the alternative</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>a vector of probabilities</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>While Harding's algorithm is mathematically correct, 
it is problematic in its computing implementation. 
The counts become very large and normalizing 
them by combinatorials leads to significance loss. 
When that happens the functions return an error message: 
can't compute due to numerical instability.
This tends to happen when the total number of sample values 
becomes too large.
That depends also on the way the sample sizes are allocated. 
</p>


<h3>Value</h3>

<p>For <code>djt</code> it is a vector 
<code class="reqn">p = (p_1,\ldots,p_n)</code>
giving the values of 
<code class="reqn">p_i = P(JT = x_i)</code>, where <code>n</code> is the length
of the input <code>x</code>.
</p>
<p>For <code>pjt</code> it is a vector 
<code class="reqn">P = (P_1,\ldots,P_n)</code>
giving the values of 
<code class="reqn">P_i = P(JT \leq x_i)</code>.
</p>
<p>For <code>qjt</code> is a vecto r <code class="reqn">x = (x_1,\ldots,x_n)</code>,where <code class="reqn">x_i</code>
is the smallest <code class="reqn">x</code>
such that <code class="reqn">P(JT \leq x) \geq p_i</code>.
</p>


<h3>References</h3>

<p>Harding, E.F. (1984), An Efficient, Minimal-storage Procedure for
Calculating the Mann-Whitney U, Generalized U and Similar Distributions,
<em>Appl. Statist.</em> <b>33</b> No. 1, 1-6.
</p>
<p>Jonckheere, A.R. (1954), A Distribution Free <em>k</em>-sample Test against Ordered 
Alternatives,
<em>Biometrika</em>, <b>41</b>, 133-145.
</p>
<p>Lehmann, E.L. (2006),
<em>Nonparametrics, Statistical Methods Based on Ranks, Revised First Edition</em>,
Springer Verlag.
</p>
<p>Terpstra, T.J. (1952), The Asymptotic Normality and Consistency of Kendall's Test against Trend, when Ties are Present in One Ranking,
<em>Indagationes Math.</em> <b>14</b>, 327-333.
</p>


<h3>Examples</h3>

<pre><code class="language-R">djt(c(-1.5,1.2,3), 2:4)
pjt(c(2,3.4,7), 3:5)
qjt(c(0,.2,.5), 2:4)
</code></pre>


</div>