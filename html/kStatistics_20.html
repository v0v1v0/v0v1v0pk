<div class="container">

<table style="width: 100%;"><tr>
<td>MFB</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multivariate Faa di Bruno's formula</h2>

<h3>Description</h3>

<p>The function returns the coefficient indexed by the integers <code>i1,i2,...</code> of an exponential 
formal power series composition through the univariate or multivariate Faa di Bruno's formula.</p>


<h3>Usage</h3>

<pre><code class="language-R">MFB(v = c(), n = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>v</code></td>
<td>
<p>vector of integers, the subscript of the coefficient</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>integer, the number of inner functions <code>g</code>'s</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>MFB</code> function computes a coefficient of an exponential formal power series composition: 
</p>

<table>
<tr>
<td style="text-align: left;">a) </td>
<td style="text-align: left;"> univariate <code>f</code> with univariate <code>g</code>, that is <code>f[g(z)]</code>,  </td>
</tr>
<tr>
<td style="text-align: left;">
             b) </td>
<td style="text-align: left;"> univariate <code>f</code> with multivariate <code>g</code>, that is <code>f[g(z1,z2,...,zm)]</code>,  </td>
</tr>
<tr>
<td style="text-align: left;">
             c) </td>
<td style="text-align: left;"> multivariate <code>f</code> with multivariate <code>g</code>'s, that is <code>f[g1(z1,z2,...,zm),...,gn(z1,z2,...,gm)].</code>
</td>
</tr>
</table>
<p>If <code>i1</code> is the power of <code>z1</code>, <code>i2</code> is the power of <code>z2</code> and so on up to <code>im</code> power of <code>zm</code>, then 
<code>(i1,i2,....im)</code> is the subscript of the output coefficient corresponding to the product <code>z1^i1 z2^i2 ....zm^im.</code> 
Note that this coefficient gives also the (partial) derivative of order <code>(i1,i2,...,im)</code> of the composition of 
the multivariate functions <code>f</code> and <code>g</code>'s in terms of the partial derivatives of <code>f</code> and <code>g</code>'s respectively. 
See the <code>e_MFB</code> function, for evaluating this coefficient when the coefficients of 
<code>f</code> and to the coefficients of <code>g</code>'s are substituted with numerical values.</p>


<h3>Value</h3>

<table><tr style="vertical-align: top;">
<td><code>string</code></td>
<td>
<p>the expression of Faa di Bruno's formula</p>
</td>
</tr></table>
<h3>Warning</h3>

<p>The value of the first parameter is the same as the <code>mkmSet</code> function</p>


<h3>Note</h3>

<p>Called by the <code>e_MFB</code> function in the <code>kStatistics</code> package.
The routine uses the <code>mkmSet</code> function in the same package.
</p>


<h3>Author(s)</h3>

<p>Elvira Di Nardo <a href="mailto:elvira.dinardo@unito.it">elvira.dinardo@unito.it</a>,<br> 
Giuseppe Guarino <a href="mailto:giuseppe.guarino@rete.basilicata.it">giuseppe.guarino@rete.basilicata.it</a>
</p>


<h3>References</h3>

<p>G. M. Constantine, T. H. Savits  (1996) A Multivariate Faa Di Bruno Formula With 
Applications. Trans. Amer. Math. Soc. 348(2), 503-520.
</p>
<p>E. Di Nardo, G. Guarino, D. Senato (2008) An unifying framework for k-statistics, polykays and their generalizations. 
Bernoulli. 14(2), 440-468. (download from <a href="https://arxiv.org/pdf/math/0607623.pdf">https://arxiv.org/pdf/math/0607623.pdf</a>) 
</p>
<p>E. Di Nardo, G. Guarino, D. Senato (2008) Symbolic computation of moments of sampling distributions. 
Comp. Stat. Data Analysis. 52(11), 4909-4922. (download from <a href="https://arxiv.org/abs/0806.0129">https://arxiv.org/abs/0806.0129</a>) 
</p>
<p>E. Di Nardo E., G. Guarino, D. Senato (2011) A new algorithm for computing the multivariate Faa di Bruno's formula. 
Appl. Math. Comp. 217, 6286-6295. (download from <a href="https://arxiv.org/abs/1012.6008">https://arxiv.org/abs/1012.6008</a>)
</p>


<h3>See Also</h3>

<p><code>mkmSet</code>,
<code>e_MFB</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
#----------------------------------------#
# Univariate f with Univariate g         #
#----------------------------------------#

# The coefficient of z^2 in f[g(z)], that is f[2]g[1]^2 + f[1]g[2], where 
# f[1] is the coefficient of x in f(x) with x=g(z) 
# f[2] is the coefficient of x^2 in f(x) with  x=g(z) 
# g[1] is the coefficient of z in g(z)   
# g[2] is the coefficient of z^2 in g(z)   
# 
MFB( c(2), 1 )

# The coefficient of z^3 in f[g(z)], that is f[3]g[1]^3 + 3f[2]g[1]g[2] + f[1]g[3] 
#
MFB( c(3), 1 )

#----------------------------------------#
#  Univariate f with Multivariate g      #
#----------------------------------------#

# The coefficient of z1 z2 in f[g(z1,z2)], that is f[1]g[1,1] + f[2]g[1,0]g[0,1] 
# where 
# f[1]   is the coefficient of x in f(x) with x=g(z1,z2)
# f[2]   is the coefficient of x^2 in f(x) with x=g(z1,z2) 
# g[1,0] is the coefficient of z1 in g(z1,z2) 
# g[0,1] is the coefficient of z2 in g(z1,z2)  
# g[1,1] is the coefficient of z1 z2 in g(z1,z2)  
# 
MFB( c(1,1), 1 )

# The coefficient of z1^2 z2 in f[g(z1,z2)] 
#
MFB( c(2,1), 1 )

# The coefficient of z1 z2 z3 in f[g(z1,z2,z3)] 
#
MFB( c(1,1,1), 1 )

#----------------------------------------------------------------#
#  Multivariate f with Univariate/Multivariate g1, g2, ..., gn   #
#----------------------------------------------------------------#

# The coefficient of z in f[g1(z),g2(z)], that is  f[1,0]g1[1] + f[0,1]g2[1] where 
# f[1,0] is the coefficient of x1 in f(x1,x2) with x1=g1(z) and x2=g2(z)
# f[0,1] is the coefficient of x2 in f(x1,x2) with x1=g1(z) and x2=g2(z)
# g1[1]  is the coefficient of z of g1(z)  
# g2[1]  is the coefficient of z of g2(z)  
MFB( c(1), 2 )

# The coefficient of z1 z2 in f[g1(z1,z2),g2(z1,z2)], that is
# f[1,0]g1[1,1] + f[2,0]g1[1,0]g1[0,1] + f[0,1]g2[1,1] + f[0,2]g2[1,0]g2[0,1] + 
# f[1,1]g1[1,0]g2[0,1] + f[1,1]g1[0,1]g2[1,0] where 
# f[1,0]  is the coefficient of x1 in f(x1,x2) with x1=g1(z1,z2) and x2=g2(z1,z2)
# f[0,1]  is the coefficient of x2 in f(x1,x2) with x1=g1(z1,z2) and x2=g2(z1,z2)
# g1[1,1] is the coefficient of z1z2 in g1(z1,z2)  
# g1[1,0] is the coefficient of z1 in g1(z1,z2)   
# g1[0,1] is the coefficient of z2 in g1(z1,z2)  
# g2[1,1] is the coefficient of z1 z2 in g2(z1,z2)  
# g2[1,0] is the coefficient of z1 in g2(z1,z2)  
# g2[0,1] is the coefficient of z2 in g1(z1,z2)  
MFB( c(1,1), 2 )

# The coefficient of z1 in f[g1(z1,z2),g2(z1,z2),g3(z1,z2)] 
MFB( c(1,0), 3 )

# The coefficient of z1 z2 in f[g1(z1,z2),g2(z1,z2),g3(z1,z2)] 
MFB( c(1,1), 3 )

# The coefficient of z1^2 z2 in f[g1(z1,z2),g2(z1,z2)]  
MFB( c(2,1), 2 )

# The coefficient of z1^2 z2 in f[g1(z1,z2),g2(z1,z2),g3(z1,z2)]  
MFB( c(2,1), 3 )

# The previous result expressed in a compact form
for (m in unlist(strsplit( MFB(c(2,1),3), " + ", fixed=TRUE)) ) cat( m,"\n" )

# The coefficient of z1 z2 z3 in f[g1(z1,z2,z3),g2(z1,z2,z3),g3(z1,z2,z3)]  
MFB( c(1,1,1), 3 )

# The previous result expressed in a compact form
for (m in unlist(strsplit( MFB(c(1,1,1),3), " + ", fixed=TRUE)) ) cat( m,"\n" )

</code></pre>


</div>