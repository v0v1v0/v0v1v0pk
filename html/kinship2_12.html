<div class="container">

<table style="width: 100%;"><tr>
<td>ibdMatrix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create an IBD matrix</h2>

<h3>Description</h3>

<p>Transform identity by descent (IBD) matrix data from the form produced
by external programs such as SOLAR
into the compact form used by the coxme and lmekin routines.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ibdMatrix(id1, id2, x, idmap, diagonal)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>id1, id2</code></td>
<td>
<p>pairs of subject identifiers</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>the IBD value for that pair</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>idmap</code></td>
<td>
<p>an optional 2 column matrix or data frame whose first
element is the internal value (as found in <code>id1</code> and
<code>id2</code>), and whose second element will be used for the dimnames
of the result</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diagonal</code></td>
<td>
<p>optional value for the diagonal element. If present,
any missing diagonal elements in the input data will be set to this
value.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The IBD matrix for a set of n subjects will be an n by n symmetric
matrix whose i,j element is the contains, for some given genetic
location, a 0/1 indicator of whether 0, 1/2 or 2/2 of the alleles for i
and j are identical by descent.  Fractional values occur if the IBD
fraction must be imputed.  The diagonal will be 1.
Since a large fraction of the values will be zero, programs such as
Solar return a data set containing only the non-zero elements.  As
well, Solar will have renumbered the subjects as 1:n in such a way that
families are grouped together in the matrix; a separate index file
contains the mapping between this new id and the original one.
The final matrix should be labeled with the original identifiers.
</p>


<h3>Value</h3>

<p>a sparse matrix of class <code>dsCMatrix</code>.  This is the same form
used for kinship matrices.
</p>


<h3>See Also</h3>

<p><code>kinship</code>,
<code>Matrix</code>
</p>


</div>