<div class="container">

<table style="width: 100%;"><tr>
<td>kPCA_arrows</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot the original variables' contribution to a PCA plot</h2>

<h3>Description</h3>

<p>'kPCA_arrows()' draws arrows on a (kernel) PCA plot to represent the contribution
of the original variables to the two displayed Principal Components (PCs).
</p>


<h3>Usage</h3>

<pre><code class="language-R">kPCA_arrows(plot, contributions, colour = "steelblue", size = 4, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>A kernel PCA plot generated by 'kPCA()'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contributions</code></td>
<td>
<p>The variables contributions, for instance obtained via 'kPCA_imp()'.
It is not mandatory to draw all the original variables; a subset of interest
can be passed on to this argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colour</code></td>
<td>
<p>Color of arrows and labels. (Defaults: "steelblue").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size</code></td>
<td>
<p>Size of the labels. (Defaults: 4).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional parameters passed on to geom_segments() and geom_text().</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>It is important to note that the arrows are scaled to match the samples' projection
plot. Thus, arrows' directions are correct, but do not expect that their magnitudes
match the output of 'kPCA_imp()' or other functions('prcomp', 'princomp...').
(Nevertheless, they should at least be proportional to the real magnitudes.)
</p>


<h3>Value</h3>

<p>The PCA plot with the arrows ('ggplot2' object).
</p>


<h3>Examples</h3>

<pre><code class="language-R">dat &lt;- matrix(rnorm(500),ncol=10,nrow=50)
K &lt;- Linear(dat)

## Computing the kernel PCA. The plot represents PC1 and PC2:
kpca &lt;- kPCA(K,plot=1:2)

## Computing the contributions to all the PCS:
pcs &lt;- kPCA_imp(dat,secure=FALSE)

## We will draw the arrows for PC1 and PC2.
contributions &lt;- t(pcs$loadings[1:2,])
rownames(contributions) &lt;- 1:10
kPCA_arrows(plot=kpca$plot,contributions=contributions)
</code></pre>


</div>